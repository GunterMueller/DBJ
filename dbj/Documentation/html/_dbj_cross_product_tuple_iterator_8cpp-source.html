<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Jenas Datenbanksystem &apos;System J&apos;: DbjCrossProductTupleIterator.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>DbjCrossProductTupleIterator.cpp</h1><a href="_dbj_cross_product_tuple_iterator_8cpp.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*************************************************************************\</span>
00002 <span class="comment"> *                                                                       *</span>
00003 <span class="comment"> * (C) 2004-2005                                                         *</span>
00004 <span class="comment"> * Lehrstuhl fuer Datenbanken und Informationssysteme                    *</span>
00005 <span class="comment"> * Friedrich-Schiller-Universitaet Jena                                  *</span>
00006 <span class="comment"> * Ernst-Abbe-Platz 1-2                                                  *</span>
00007 <span class="comment"> * 07745 Jena                                                            *</span>
00008 <span class="comment"> *                                                                       *</span>
00009 <span class="comment">\*************************************************************************/</span>
00010 
00011 <span class="preprocessor">#include &lt;iostream&gt;</span>
00012 
00013 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00014 
00015 <span class="preprocessor">#include "<a class="code" href="_dbj_cross_product_tuple_iterator_8hpp.html">DbjCrossProductTupleIterator.hpp</a>"</span>
00016 <span class="preprocessor">#include "<a class="code" href="_dbj_cross_product_tuple_8hpp.html">DbjCrossProductTuple.hpp</a>"</span>
00017 <span class="preprocessor">#include "<a class="code" href="_dbj_tuple_8hpp.html">DbjTuple.hpp</a>"</span>
00018 
00019 
<a name="l00020"></a><a class="code" href="_dbj_cross_product_tuple_iterator_8cpp.html#a0">00020</a> <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="_dbj_components_8hpp.html#a12">DbjComponent</a> <a class="code" href="_dbj_cross_product_tuple_iterator_8cpp.html#a0">componentId</a> = <a class="code" href="_dbj_components_8hpp.html#a12a5">RunTime</a>;
00021 
00022 
00023 <span class="comment">// Konstruktor</span>
<a name="l00024"></a><a class="code" href="class_dbj_cross_product_tuple_iterator.html#a0">00024</a> <a class="code" href="class_dbj_cross_product_tuple_iterator.html#a0">DbjCrossProductTupleIterator::DbjCrossProductTupleIterator</a>(
00025         <a class="code" href="class_dbj_tuple_iterator.html">DbjTupleIterator</a> &amp;left, <a class="code" href="class_dbj_tuple_iterator.html">DbjTupleIterator</a> &amp;right)
00026     : leftSubIterator(left), rightSubIterator(right),
00027       cpTuple(NULL), emptyCrossProduct(false)
00028 {
00029     <a class="code" href="group__trace__def.html#ga0">DBJ_TRACE_ENTRY</a>();
00030     
00031     <span class="keywordflow">if</span> (!<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r0">leftSubIterator</a>.<a class="code" href="class_dbj_iterator.html#a1">hasNext</a>() || !<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r1">rightSubIterator</a>.<a class="code" href="class_dbj_iterator.html#a1">hasNext</a>()) {
00032         <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r3">emptyCrossProduct</a> = <span class="keyword">true</span>;                   
00033     }
00034 }
00035 
00036 
00037 <span class="comment">// Gib naechstes Tupel zurueck</span>
<a name="l00038"></a><a class="code" href="class_dbj_cross_product_tuple_iterator.html#a2">00038</a> <a class="code" href="_dbj_error_codes_8hpp.html#a107">DbjErrorCode</a> <a class="code" href="class_dbj_cross_product_tuple_iterator.html#a2">DbjCrossProductTupleIterator::getNextTuple</a>(<a class="code" href="class_dbj_tuple.html">DbjTuple</a> *&amp;tuple)
00039 {
00040     <a class="code" href="_dbj_error_codes_8hpp.html#a107">DbjErrorCode</a> rc = <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>;
00041     <a class="code" href="class_dbj_tuple.html">DbjTuple</a> *subTuple = NULL;
00042 
00043     <a class="code" href="group__trace__def.html#ga0">DBJ_TRACE_ENTRY</a>();
00044 
00045     <span class="comment">// leeres Kreuzprodukt?</span>
00046     <span class="keywordflow">if</span> (<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r3">emptyCrossProduct</a>) {
00047         <a class="code" href="_dbj_error_8hpp.html#a1">DBJ_SET_ERROR</a>(<a class="code" href="_dbj_error_codes_8hpp.html#a107a4">DBJ_NOT_FOUND_WARN</a>);
00048         <span class="keywordflow">goto</span> cleanup;
00049     }
00050 
00051     <span class="comment">// Erzeuge Objekt fuer Ergebnis, wenn benoetigt</span>
00052     <span class="keywordflow">if</span> (!<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r2">cpTuple</a>) {
00053         <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r2">cpTuple</a> = <span class="keyword">new</span> <a class="code" href="class_dbj_cross_product_tuple.html">DbjCrossProductTuple</a>();
00054         <span class="keywordflow">if</span> (!<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r2">cpTuple</a>) {
00055             <span class="keywordflow">goto</span> cleanup;
00056         }
00057 
00058         <span class="comment">// linkes Sub-Tupel muss noch initialisiert werden (rechts wird gleich</span>
00059         <span class="comment">// im Anschluss abgedeckt)</span>
00060         rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r0">leftSubIterator</a>.<a class="code" href="class_dbj_tuple_iterator.html#a1">getNextTuple</a>(subTuple);
00061         <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00062             <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00063             <span class="keywordflow">goto</span> cleanup;
00064         }
00065         rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r2">cpTuple</a>-&gt;<a class="code" href="class_dbj_cross_product_tuple.html#a12">setLeftTuple</a>(subTuple);
00066         <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00067             <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00068             <span class="keywordflow">goto</span> cleanup;
00069         }
00070         subTuple = NULL;
00071     }
00072 
00073     <span class="keywordflow">if</span> (<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r1">rightSubIterator</a>.<a class="code" href="class_dbj_iterator.html#a1">hasNext</a>()) {
00074         rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r1">rightSubIterator</a>.<a class="code" href="class_dbj_tuple_iterator.html#a1">getNextTuple</a>(subTuple);
00075         <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00076             <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00077             <span class="keywordflow">goto</span> cleanup;
00078         }
00079         rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r2">cpTuple</a>-&gt;<a class="code" href="class_dbj_cross_product_tuple.html#a13">setRightTuple</a>(subTuple);
00080         <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00081             <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00082             <span class="keywordflow">goto</span> cleanup;
00083         }
00084         subTuple = NULL;
00085     }
00086     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r0">leftSubIterator</a>.<a class="code" href="class_dbj_iterator.html#a1">hasNext</a>()) {
00087         rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r0">leftSubIterator</a>.<a class="code" href="class_dbj_tuple_iterator.html#a1">getNextTuple</a>(subTuple);
00088         <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00089             <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00090             <span class="keywordflow">goto</span> cleanup;
00091         }
00092         rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r2">cpTuple</a>-&gt;<a class="code" href="class_dbj_cross_product_tuple.html#a12">setLeftTuple</a>(subTuple);
00093         <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00094             <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00095             <span class="keywordflow">goto</span> cleanup;
00096         }
00097         subTuple = NULL;
00098 
00099         <span class="comment">// starte rechts mit neuem Scan</span>
00100         rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r1">rightSubIterator</a>.<a class="code" href="class_dbj_iterator.html#a2">reset</a>();
00101         <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00102             <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00103             <span class="keywordflow">goto</span> cleanup;
00104         }
00105         rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r1">rightSubIterator</a>.<a class="code" href="class_dbj_tuple_iterator.html#a1">getNextTuple</a>(subTuple);
00106         <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00107             <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00108             <span class="keywordflow">goto</span> cleanup;
00109         }
00110         rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r2">cpTuple</a>-&gt;<a class="code" href="class_dbj_cross_product_tuple.html#a13">setRightTuple</a>(subTuple);
00111         <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00112             <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00113             <span class="keywordflow">goto</span> cleanup;
00114         }
00115         subTuple = NULL;
00116     }
00117     <span class="keywordflow">else</span> {
00118         <a class="code" href="_dbj_error_8hpp.html#a1">DBJ_SET_ERROR</a>(<a class="code" href="_dbj_error_codes_8hpp.html#a107a4">DBJ_NOT_FOUND_WARN</a>);
00119         <span class="keywordflow">goto</span> cleanup;
00120     }
00121 
00122     <span class="comment">// setze Ergebnis</span>
00123     tuple = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r2">cpTuple</a>;
00124 
00125  cleanup:
00126     <span class="keywordflow">return</span> <a class="code" href="_dbj_error_8hpp.html#a11">DbjGetErrorCode</a>();
00127 }
00128 
00129 
<a name="l00130"></a><a class="code" href="class_dbj_cross_product_tuple_iterator.html#a3">00130</a> <span class="keywordtype">bool</span> <a class="code" href="class_dbj_cross_product_tuple_iterator.html#a3">DbjCrossProductTupleIterator::hasNext</a>()<span class="keyword"> const</span>
00131 <span class="keyword"></span>{
00132     <a class="code" href="group__trace__def.html#ga0">DBJ_TRACE_ENTRY</a>();
00133 
00134     <span class="keywordflow">if</span> (<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r3">emptyCrossProduct</a>) {
00135         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00136     }
00137 
00138     <span class="comment">// zuerst rechts testen, um nicht bei der aeusseren Tabelle was zu</span>
00139     <span class="comment">// veraendern</span>
00140     <span class="keywordflow">if</span> (<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r1">rightSubIterator</a>.<a class="code" href="class_dbj_iterator.html#a1">hasNext</a>()) {
00141         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00142     }
00143     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_dbj_cross_product_tuple_iterator.html#r0">leftSubIterator</a>.<a class="code" href="class_dbj_iterator.html#a1">hasNext</a>()) {
00144         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00145     }
00146 
00147     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00148 }
00149 
<a name="l00150"></a><a class="code" href="class_dbj_cross_product_tuple_iterator.html#a4">00150</a> <a class="code" href="_dbj_error_codes_8hpp.html#a107">DbjErrorCode</a> <a class="code" href="class_dbj_cross_product_tuple_iterator.html#a4">DbjCrossProductTupleIterator::reset</a>()
00151 {
00152     <a class="code" href="_dbj_error_codes_8hpp.html#a107">DbjErrorCode</a> rc = <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>;
00153     <a class="code" href="class_dbj_tuple.html">DbjTuple</a> *subTuple = NULL;
00154 
00155     <a class="code" href="group__trace__def.html#ga0">DBJ_TRACE_ENTRY</a>();
00156 
00157     rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r1">rightSubIterator</a>.<a class="code" href="class_dbj_iterator.html#a2">reset</a>();
00158     <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00159         <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00160         <span class="keywordflow">goto</span> cleanup;
00161     }
00162     rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r0">leftSubIterator</a>.<a class="code" href="class_dbj_iterator.html#a2">reset</a>();
00163     <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00164         <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00165         <span class="keywordflow">goto</span> cleanup;
00166     }
00167     rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r0">leftSubIterator</a>.<a class="code" href="class_dbj_tuple_iterator.html#a1">getNextTuple</a>(subTuple);
00168     <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00169         <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00170         <span class="keywordflow">goto</span> cleanup;
00171     }
00172     rc = <a class="code" href="class_dbj_cross_product_tuple_iterator.html#r2">cpTuple</a>-&gt;<a class="code" href="class_dbj_cross_product_tuple.html#a12">setLeftTuple</a>(subTuple);
00173     <span class="keywordflow">if</span> (rc != <a class="code" href="_dbj_error_codes_8hpp.html#a107a1">DBJ_SUCCESS</a>) {
00174         <a class="code" href="_dbj_error_8hpp.html#a8">DBJ_TRACE_ERROR</a>();
00175         <span class="keywordflow">goto</span> cleanup;
00176     }
00177 
00178  cleanup:
00179     <span class="keywordflow">return</span> <a class="code" href="_dbj_error_8hpp.html#a11">DbjGetErrorCode</a>();
00180 }
00181 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Mon Jul 4 15:40:29 2005 for Jenas Datenbanksystem 'System J' by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.8 </small></address>
</body>
</html>
